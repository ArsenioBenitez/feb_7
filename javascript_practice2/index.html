<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Fast & Tedious</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div id="speed-meter">
      <img id="crack"  src="crack.png">
      <img id=meter-background src="speed_meter.png" alt="">
      <img id="meter-needle" src="meter_needle2.png" alt="">
    </div>
    <div id="control-panel">
      <img id="rotation" src="tire.png" width="100px" height="100px">
      <center>
        <button type="button" id="accel-pedal" name="button">ACCEL<br>PEDAL</button>
        <button type="button" id="brake-pedal" name="button">BRAKE<br>PEDAL</button>
        <button type="button" id="stop-sound" name="button">STOP<br>SOUND</button></center>
      </center>
      <audio id="sound-honda" src="honda.wav" preload="auto"></audio>
      <audio id="sound-alarm" src="alarm.wav" preload="auto"></audio>
      <audio id="sound-crash" src="crash.wav" preload="auto"></audio>
    </div>

  </body>

  <script>

    var initial_deg = 0;
    var max_degree = 290;

    /*pictures*/
    var needle = document.getElementById('meter-needle');
    degStr = "rotate(" + initial_deg + "deg)";/*Degree string - This specifies the degree which the needle is moving toward.*/
    needle.style.transform = degStr;/*Upon setting transform attribute, the needle moves to the degree specified by degStr*/
    var crack = document.getElementById('crack');

    /*HTML elements*/
    var accelPedal = document.getElementById("accel-pedal");
    var brakePedal = document.getElementById("brake-pedal");
    var soundStopButton = document.getElementById("stop-sound");

    /*Audio*/
    var engineAudio = document.getElementById("sound-honda");
    var alarmAudio = document.getElementById("sound-alarm");
    var crashAudio = document.getElementById("sound-crash")

    accelPedal.addEventListener("mousedown", function(){
      accelerate();
      engineAudio.play();
      });

    accelPedal.addEventListener("mouseup", function(){
      slowDown();
      });

    brakePedal.addEventListener("mousedown", function(){
        brake();
        alarmAudio.play();
        crashAudio.play();
        });

    soundStopButton.addEventListener("click", function(){
      crashAudio.pause();
      crashAudio.currentTime = 0;
      alarmAudio.pause();
      alarmAudio.currentTime = 0;
    });
    /*brakePedal.addEventListener("mouseup", function(){
        slowDown();
      });*/

    var accelerate = function(){
        degStr = "rotate(" + max_degree + "deg)";
        needle.style.transition = "10s"; /*acceleration speed*/
        needle.style.transform = degStr;
        brakePedal.style.visibility = "visible";
        /*Upon setting transform attribute, the needle moves to the degree specified by degStr*/
        /*The speed at which the needle moves to degStr is specified by transition attribute*/
    };
    var brake = function(){
        degStr = "rotate(" + initial_deg + "deg)";
        console.log(degStr);
        needle.style.transition = "1s"; /*acceleration speed*/
        needle.style.transform = degStr;
        var mssg = 'Warning: BREAKS FAILURE!!';
        crack.style.visibility = "visible";
        window.alert(mssg);
        /*Upon setting transform attribute, the needle moves to the degree specified by degStr*/
        /*The speed at which the needle moves to degStr is specified by transition attribute*/
    };

    var slowDown = function(){
      degStr = "rotate(" + initial_deg + "deg)";
      needle.style.transition = "200s"/*Slow down speed*/
      needle.style.transform = degStr;
    };

    /*Adjust tire speed*/
    var adjustTireSpeed = function(){
      var currentTransform = window.getComputedStyle(needle).transform;
      var currentDegree = transformParserToDegree(currentTransform);
      console.log(currentDegree);
    }
    setInterval(adjustTireSpeed, 1000);

    /*Reference: https://css-tricks.com/get-value-of-css-rotation-through-javascript/*/
    /*To extract the degree from transform attribute*/
      var transformParserToDegree = function(trans){

    }

</script>
</html>
